<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winery Fermentation Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Fermentation Log</h1>
        <button id="toggleOverviewBtn">Show Overview</button>
    </header>
    <main>
        <section class="overview hidden">
            <h2>Overview</h2>
            <table id="overviewTable">
                <thead>
                    <tr>
                        <th>Tank</th>
                        <th>Date & Time</th>
                        <th>Temp (°C)</th>
                        <th>Sugar (Baumé)</th>
                        <th>Specific Gravity</th>
                        <th>pH</th>
                        <th>TA (g/L)</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="overviewTableBody"></tbody>
            </table>
        </section>
        <section class="tank-info">
            <h2>Select Tank</h2>
            <div class="info-inputs">
                <label for="tankSelect">Tank:</label>
                <select id="tankSelect"></select>
                
                <p id="tankDetails"></p>
            </div>
        </section>

        <section class="data-entry">
            <h2>New Reading / Addition</h2>
            <form id="readingForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="timestamp">Date & Time</label>
                        <input type="datetime-local" id="timestamp" required>
                    </div>
                    <div class="form-group">
                        <label for="temperature">Temperature (°C)</label>
                        <input type="number" id="temperature" step="0.1" placeholder="e.g., 15.5">
                    </div>
                     <div class="form-group">
                        <label for="sugar">Sugar (Baumé)</label>
                        <input type="number" id="sugar" step="0.1" placeholder="e.g., 12.5">
                    </div>
                    <div class="form-group">
                        <label for="sg">Specific Gravity</label>
                        <input type="number" id="sg" step="0.001" placeholder="e.g., 1.020">
                    </div>
                    <div class="form-group">
                        <label for="ph">pH</label>
                        <input type="number" id="ph" step="0.01" placeholder="e.g., 3.25">
                    </div>
                    <div class="form-group">
                        <label for="ta">Total Acidity (g/L)</label>
                        <input type="number" id="ta" step="0.1" placeholder="e.g., 6.8">
                    </div>
                    <div class="form-group">
                        <label for="volume">Volume (L)</label>
                        <input type="number" id="volume" step="0.1" placeholder="e.g., 1000">
                    </div>
                    <div class="form-group full-width">
                        <label for="notes">Additions & Notes</label>
                        <textarea id="notes" rows="3" placeholder="e.g., Added 50g of Nutrient X"></textarea>
                    </div>
                </div>
                <button type="submit">Save Reading</button>
            </form>
        </section>

        <section class="calculator">
            <h2>Additive Calculator</h2>
            <p>Enter the batch volume and dosage rates. For g/hL rates, amount&nbsp;=&nbsp;volume&nbsp;×&nbsp;rate&nbsp;/&nbsp;100. For SO₂ (KMS) in mg/L, amount&nbsp;=&nbsp;volume&nbsp;×&nbsp;rate&nbsp;/&nbsp;1000.</p>
            <div class="form-group">
                <label for="calcVolume">Volume (L)</label>
                <input type="number" id="calcVolume" step="0.1" placeholder="e.g., 1000">
            </div>
            <table class="calc-table">
                <thead>
                    <tr>
                        <th>Additive</th>
                        <th>Dosage Rate</th>
                        <th>Amount (g)</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Nutrients (g/hL)</td>
                        <td><input type="number" id="nutrientRate" step="0.01" placeholder="e.g., 20"></td>
                        <td><span id="nutrientAmount"></span></td>
                        <td><button type="button" id="nutrientSave">Save to Log</button></td>
                    </tr>
                    <tr>
                        <td>Enzymes (g/hL)</td>
                        <td><input type="number" id="enzymeRate" step="0.01" placeholder="e.g., 2"></td>
                        <td><span id="enzymeAmount"></span></td>
                        <td><button type="button" id="enzymeSave">Save to Log</button></td>
                    </tr>
                    <tr>
                        <td>SO₂ (KMS) (mg/L)</td>
                        <td><input type="number" id="kmsRate" step="1" placeholder="e.g., 50"></td>
                        <td><span id="kmsAmount"></span></td>
                        <td><button type="button" id="kmsSave">Save to Log</button></td>
                    </tr>
                    <tr>
                        <td>Bentonite (g/hL)</td>
                        <td><input type="number" id="bentoniteRate" step="0.01" placeholder="e.g., 10"></td>
                        <td><span id="bentoniteAmount"></span></td>
                        <td><button type="button" id="bentoniteSave">Save to Log</button></td>
                    </tr>
                    <tr>
                        <td>Tannins (g/hL)</td>
                        <td><input type="number" id="tanninRate" step="0.01" placeholder="e.g., 5"></td>
                        <td><span id="tanninAmount"></span></td>
                        <td><button type="button" id="tanninSave">Save to Log</button></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="log-display">
            <h2>Log History for <span id="logTankId">...</span></h2>
            <table id="logTable">
                <thead>
                    <tr>
                        <th>Date & Time</th>
                        <th>Temp (°C)</th>
                        <th>Sugar (Baumé)</th>
                        <th>Specific Gravity</th>
                        <th>pH</th>
                        <th>TA (g/L)</th>
                        <th>Volume (L)</th>
                        <th>Notes / Additions</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="logTableBody">
                    </tbody>
            </table>
        </section>

        <section class="data-management">
            <h2>Data Management</h2>
            <button id="exportJsonBtn">Export JSON</button>
            <button id="exportCsvBtn">Export CSV</button>
            <input type="file" id="importFile" accept=".json,.csv" style="display: none;">
            <button id="importJsonBtn">Import JSON</button>
            <button id="importCsvBtn">Import CSV</button>
        </section>
    </main>

    <script src="script.js"></script>
</body>
</html>
